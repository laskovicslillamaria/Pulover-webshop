DELIMITER //

CREATE PROCEDURE regisztracio(IN nev VARCHAR(50), IN email VARCHAR(50), IN jelszo VARCHAR(50), IN szuletesi_datum DATETIME)
BEGIN
    IF EXISTS (SELECT 1 FROM felhasznalok WHERE email = email) THEN
        SIGNAL SQLSTATE '45000'
            SET MESSAGE_TEXT = 'Ez az e-mail cím már létezik a rendszerben, egy e-mail cím csak egyszer használható.';
    ELSE
        INSERT INTO users (nev, email, jelszo, szuletesi_datum) VALUES (nev, email, jelszo, szuletesi_datum);
    END IF;
END //

DELIMITER ;